<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head xmlns:th="http://www.thymeleaf.org">
    <meta charset="UTF-8">
    <title>后台首页</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" type="text/css" th:href="@{/common/layui/css/layui.css}" media="all">
    <link rel="stylesheet" type="text/css" th:href="@{/common/bootstrap/css/bootstrap.css}" media="all">
    <link rel="stylesheet" type="text/css" th:href="@{/common/global.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/admin/css/main.css}" media="all">
    <script type="text/javascript" th:src="@{/common/layui/layui.js}"></script>
    <!--    <script type="text/javascript" th:src="@{/admin/jsplug/echarts.min.js}"></script>-->
    <script type="text/javascript" th:src="@{/admin/js/main.js}"></script>
</head>
<body>
<section class="larry-wrapper">
    <!-- overview -->
    <div class="row state-overview" th:hidden="${session.user.isAdmin ? false : true}">
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol userblue"><i class="iconpx-users"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.stallCount}"></h1>
                    </a>
                    <p>摊位总数</p>
                </div>
            </section>
        </div>
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol commred"><i class="iconpx-user-add"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.remainStallCount}"></h1>
                    </a>
                    <p>剩余未出租摊位</p>
                </div>
            </section>
        </div>
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol articlegreen">
                    <i class="iconpx-file-word-o"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.incomeMoney}"></h1>
                    </a>
                    <p>摊位租金收入</p>
                </div>
            </section>
        </div>
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol rsswet">
                    <i class="iconpx-check-circle"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.applyCount}"></h1>
                    </a>
                    <p>待通过的申请</p>
                </div>
            </section>
        </div>
    </div>

    <div class="row state-overview" th:hidden="${session.user.isAdmin}">
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol userblue"><i class="iconpx-users"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.rentStallCount}"></h1>
                    </a>
                    <p>租用的摊位总数</p>
                </div>
            </section>
        </div>
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol commred"><i class="iconpx-user-add"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.beforePayStallCount}"></h1>
                    </a>
                    <p>待付款的摊位数</p>
                </div>
            </section>
        </div>
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol articlegreen">
                    <i class="iconpx-file-word-o"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.payMoney}"></h1>
                    </a>
                    <p>租用摊位支出</p>
                </div>
            </section>
        </div>
        <div class="col-lg-3 col-sm-6">
            <section class="panel">
                <div class="symbol rsswet">
                    <i class="iconpx-check-circle"></i>
                </div>
                <div class="value">
                    <a href="#">
                        <h1 th:text="${data.applyCount}"></h1>
                    </a>
                    <p>待通过的申请</p>
                </div>
            </section>
        </div>
    </div>
    <!-- overview end -->
    <div class="row">
        <div class="col-lg-6">
            <section class="panel">
                <header class="panel-heading bm0">
                    <span class='span-title'>摊位概览</span>
                    <span class="tools pull-right"><a href="javascript:;" class="iconpx-chevron-down"></a></span>
                </header>
                <div class="panel-body">
                    <table class="table">
                        <tbody>
                        <tr>
                            <th style="padding-left: 20px">摊位号</th>
                            <th style="padding-left: 20px">摊位状态</th>
                            <th style="padding-left: 20px">摊位地址</th>
                            <th style="padding-left: 20px">出租时间</th>
                        </tr>
                        <tr th:each="stall : ${stalls}">
                            <td th:text="${stall.stallName}"></td>
                            <td th:text="${stall.isRented == null || !stall.isRented ? '未出租' : '已出租'}"></td>
                            <td th:text="${stall.stallAddress}"></td>
                            <td th:text="${stall.rentedTime == null ? '' : stall.rentedTime}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </section>
            <section class="panel">
                <header class="panel-heading bm0">
                    <span class='span-title'>最近申请</span>
                    <span class="tools pull-right"><a href="javascript:;" class="iconpx-chevron-down"></a></span>
                </header>
                <div class="panel-body">
                    <table class="table">
                        <tbody>
                        <tr>
                            <th style="padding-left: 20px">申请租户id</th>
                            <th style="padding-left: 20px">摊位号</th>
                            <th style="padding-left: 20px">申请状态</th>
                            <th style="padding-left: 20px">申请时间</th>
                        </tr>
                        <tr th:each="stallApply : ${stallApplies}">
                            <td th:text="${stallApply.userId}"></td>
                            <td th:text="${stallApply.stallId}"></td>
                            <td th:text="${stallApply.stallStatus == 0 ? '待管理员通过申请' : stallApply.stallStatus == 1 ? '待租户付款' : '待管理员确认付款'}"></td>
                            <td th:text="${stallApply.applyTime}"></td>
                        </tr>

                        </tbody>
                    </table>
                </div>

            </section>
        </div>

        <div class="col-lg-6">
            <!-- 系统公告 -->
            <section class="panel">
                <header class="panel-heading bm0">
                    <span class='span-title'>公告</span>
                    <span class="tools pull-right"><a href="javascript:;" class="iconpx-chevron-down"></a></span>
                </header>
                <div class="panel-body">
                    <table class="table">
                        <tbody>
                        <tr>
                            <th style="padding: 10px 20px">公告标题</th>
                            <th style="padding: 10px 20px">公告内容</th>
                            <th style="padding: 10px 20px">发布人</th>
                            <th style="padding: 10px 20px">发布时间</th>
                        </tr>
                        <tr th:each="notice : ${notices}">
                            <td th:text="${notice.noticeTitle}"></td>
                            <td th:text="${notice.noticeContent}"></td>
                            <td th:text="${notice.releaseUserNickname}"></td>
                            <td th:text="${notice.releaseTime}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </section>
            <!-- 待操作事项 -->
            <!--<section class="panel">
                <header class="panel-heading bm0">
                       <span class='span-title'>待操作事项</span>
                       <span class="tools pull-right"><a href="javascript:;" class="iconpx-chevron-down"></a></span>
                 </header>
                 <div class="panel-body">
                       <table class="table table-hover personal-task shortcut">
                           <tr>
                             <td>
                               <div class="c1">1</div>
                               <div class="c2">2</div>
                               <br>
                             </td>
                           </tr>
                       </table>
                 </div>
            </section>-->

            <!-- 支付记录 -->
            <section class="panel">
                <header class="panel-heading bm0">
                    <span class='span-title'></span>
                    <span class="tools pull-right"><a href="javascript:;" class="iconpx-chevron-down"></a></span>
                </header>
                <div class="panel-body">
                    <table class="table">
                        <tbody>
                        <tr>
                            <th style="padding: 10px 20px">支付id</th>
                            <th style="padding: 10px 20px">备注</th>
                            <th style="padding: 10px 20px">支付时间</th>
                        </tr>
                        <tr th:each="userPay : ${userPays}">
                            <td th:text="${userPay.payId}"></td>
                            <td th:text="${userPay.payUserNickname} + ' 向 ' + ${userPay.incomeUserNickname} + ' 支付了 ' + ${userPay.payMoney} + ' 元'"></td>
                            <td th:text="${userPay.payTime}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>
    </div>
</section>
<script type="text/javascript">
    layui.use(['jquery', 'layer', 'element'], function () {
        window.jQuery = window.$ = layui.jquery;
        window.layer = layui.layer;
        window.element = layui.element();

        $('.panel .tools .iconpx-chevron-down').click(function () {
            var el = $(this).parents(".panel").children(".panel-body");
            if ($(this).hasClass("iconpx-chevron-down")) {
                $(this).removeClass("iconpx-chevron-down").addClass("iconpx-chevron-up");
                el.slideUp(200);
            } else {
                $(this).removeClass("iconpx-chevron-up").addClass("iconpx-chevron-down");
                el.slideDown(200);
            }
        })

    });
</script>
</body>
</html>